<!DOCTYPE html>
<html lang="da">
<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <title>TrendAgent Daily Fokus</title>
    <style>
        body { font-family: 'Segoe UI', Roboto, Helvetica, Arial, sans-serif; background: #f0f2f5; margin: 20px; color: #333; }
        .container { max-width: 1000px; margin: auto; background: white; padding: 30px; border-radius: 12px; box-shadow: 0 4px 20px rgba(0,0,0,0.08); }
        
        /* Header & Stats Cards */
        .header { display: flex; justify-content: space-between; align-items: center; margin-bottom: 25px; border-bottom: 2px solid #eee; padding-bottom: 15px; }
        .stats-grid { display: grid; grid-template-columns: 1fr 1fr; gap: 20px; margin-bottom: 30px; }
        .card { padding: 15px; border-radius: 10px; border: 1px solid #e0e0e0; }
        .card.top { border-top: 5px solid #28a745; background: #f8fff9; }
        .card.bottom { border-top: 5px solid #d93025; background: #fff8f8; }
        .card h4 { margin: 0 0 10px 0; font-size: 14px; color: #666; text-transform: uppercase; }

        /* Tabel Design */
        table { width: 100%; border-collapse: collapse; margin-top: 10px; font-size: 14px; }
        th { background: #f8f9fa; padding: 12px; text-align: left; color: #666; border-bottom: 2px solid #dee2e6; }
        td { padding: 12px; border-bottom: 1px solid #eee; }
        .active-row { background: #fffde7 !important; font-weight: 600; }
        
        /* Indicators */
        .badge { padding: 4px 8px; border-radius: 4px; font-weight: bold; font-size: 11px; color: white; }
        .bg-bull { background: #28a745; }
        .bg-bear { background: #d93025; }
        .pos { color: #28a745; }
        .neg { color: #d93025; }
    </style>
</head>
<body>
    <div class="container">
        <div class="header">
            <div>
                <h1 style="margin:0; font-size: 24px;">üöÄ TrendAgent Daily Fokus</h1>
                <small style="color: #888;">Data opdateret: {{ timestamp }}</small>
            </div>
            <div style="text-align: right;">
                <span class="badge" style="background: #1a73e8; padding: 8px 15px;">STATUS: AKTIV</span>
            </div>
        </div>

        <div class="stats-grid">
            <div class="card top">
                <h4>üìà Dagens St√¶rkeste (1D %)</h4>
                {% for f in funds[:3] %}
                <div style="display:flex; justify-content:space-between; font-size: 13px; margin-bottom: 5px;">
                    <span>{{ f.name[:25] }}</span>
                    <span class="pos">+{{ "%.2f"|format(f.day_chg) }}%</span>
                </div>
                {% endfor %}
            </div>
            <div class="card bottom">
                <h4>üìâ Dagens Svageste (1D %)</h4>
                {% for f in funds[-3:]|reverse %}
                <div style="display:flex; justify-content:space-between; font-size: 13px; margin-bottom: 5px;">
                    <span>{{ f.name[:25] }}</span>
                    <span class="neg">{{ "%.2f"|format(f.day_chg) }}%</span>
                </div>
                {% endfor %}
            </div>
        </div>

        <table>
            <thead>
                <tr>
                    <th>Fond</th>
                    <th>Signal</th>
                    <th>Egen %</th>
                    <th>Trend</th>
                    <th>MA200 %</th>
                    <th>1D %</th>
                    <th>DD</th>
                </tr>
            </thead>
            <tbody>
                {% for f in funds %}
                <tr class="{{ 'active-row' if f.is_active else '' }}">
                    <td>{{ '‚≠ê ' if f.is_active else '' }}{{ f.name[:35] }}</td>
                    <td style="font-weight:bold; color: {{ '#1a73e8' if 'K√òB' in f.signal else '#d93025' if 'SALG' in f.signal else '#666' }}">
                        {{ f.signal }}
                    </td>
                    <td class="{{ 'pos' if (f.total_return or 0) > 0 else 'neg' if f.total_return is not none else '' }}">
                        {{ '%+.1f'|format(f.total_return) if f.total_return is not none else '‚Äì' }}%
                    </td>
                    <td><span class="badge bg-{{ f.t_state|lower }}">{{ f.t_state }}</span></td>
                    <td style="font-weight:bold;">{{ '%+.1f'|format(f.dist_ma200) }}%</td>
                    <td class="{{ 'pos' if f.day_chg > 0 else 'neg' }}">{{ '%+.2f'|format(f.day_chg) }}%</td>
                    <td style="color:#d93025">{{ '%.1f'|format(f.drawdown) }}%</td>
                </tr>
                {% endfor %}
            </tbody>
        </table>
    </div>
</body>
</html>
